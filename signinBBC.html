<!doctype html>
<html>
<head>
 <title>Learning CSS</title>

 <meta charset="utf-8" />
 <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
 </script>
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 <link rel="stylesheet" href="cssBBCsignin.css">
</head>
<body>
	<header>
		<div id="delcross"><a href="indexBBC.html"><i class="material-icons">close</i></a></div>
		<div class="fixedwidth">
			<div id="formdiv">
				<form method="get" action='#' onsubmit="checkuser()" id="signinform">	
					<img src="images/BBClogo.png">
					<h2>Sign in</h2>
					<div class="group">
						<input id="username" type="text" name="username" required />
						<label for="username">Email or username</label>
						<span class="bar"></span>
						<div class="errorbar"></div>
						<p class="errormess">Sorry, that username's too short. It needs to be at least two characters.</p>
						<p id="errormess2">Something's missing. Please check and try again.</p>
					</div>
					<div class="group">
						<input id="password" type="Password" name="password" required>
						<label for="password">Password</label>
						<span class="bar"></span>
						<div class="errorbar"></div>
						<p class="errormess">Sorry, that password is too short. It needs to be six characters or more.</p>
					</div>
					<button type="submit" form="signinform" id="signin">Sign in</button>
					<p id="lastp"><a href='#'>Need help signing in?</a></p>
				</form>
			</div>
			<div id="formdiv2">
				<h3>Don't have a BBC account yet?</h3>
				<p><a href='#'>Register now</a></p>
			</div>
		</div>
	</header>
	<footer>
		Footer info here
	</footer>

<script>
var kusercheck = false;
var kpasscheck = false;
var emailcheck = /^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/;

$(document).ready(function(){
	$(document).on("keypress", "form", function(event) { 
    	return event.keyCode != 13;
	});	
	$("input").on("keyup", function() {
		if($(this).attr("id") == "username" && kusercheck == false) {
			kusercheck = true
			console.log(kusercheck);
		} else if($(this).attr("id") == "password" && kpasscheck == false) {
			kpasscheck = true;
			console.log(kpasscheck);
		}
		if($(this).attr("id") == "password" && $("#password").val().length > 5) {
    		$("#password").siblings(".errormess").css("display", "none");
    		$("#password").siblings(".errorbar").css("display", "none");
    		console.log("check password length");
    	} else if($(this).attr("id") == "username" && $("#username").val().indexOf("@") != -1) {
    		if((emailcheck.test($("#username").val()))) {	
    			$("#username").siblings('#errormess2').css("display", "none");
		    	$("#username").siblings(".errormess").css("display", "none");
		    	$("#username").siblings(".errorbar").css("display", "none");
		    }
	    	console.log("valid email");
	    } else if( $("#username").val().length > 1) {
    		$("#username").siblings("#errormess2").css("display", "none");
    		$("#username").siblings(".errormess").css("display", "none");
    		$("#username").siblings(".errorbar").css("display", "none");
    		console.log("check username length");
    	}
	});
	

    $("input").on('blur', function(){
    	var a = $(this).attr("id");
    	var l = $(this).val().length;
    	//hasAmp = patt1.test($("#username").val());

    	if(l === 0 && a == "username" && kusercheck)  {
			$("#username").siblings("#errormess2").text("Something's missing. Please check and try again.").css("display", "block");
			$("#username").siblings(".errormess").css("display", "none");
			$("#username").siblings(".errorbar").css("display", "block");
			console.log("check blur kusercheck");
		} else if(l === 0 && a == "password" && kpasscheck) {  		
			$("#password").siblings(".errormess").css("display", "block");
			$("#password").siblings(".errorbar").css("display", "block"); 
			console.log("check blur kpasscheck");
    	} else if($("#username").val().indexOf("@") != -1) {
    		if(!(emailcheck.test($("#username").val()))) {
	    		$("#username").siblings("#errormess2").text("Sorry, that doesn't look right. Please check it's a proper email.").css("display", "block");
	    		$("#username").siblings(".errormess").css("display", "none");
	    		$("#username").siblings(".errorbar").css("display", "block");
	    		console.log("blur not valid email");
    		} else {
    			console.log("blur valid email");
    		}
    	} else if(l == 0) {
    		//do nothing
    	} else if(l == 1) {
    		if(a == "username") {
	    		$("#username").siblings('#errormess2').css("display", "none");
	    		$("#username").siblings(".errormess").css("display", "block");
	    		$("#username").siblings(".errorbar").css("display", "block");
	    		console.log("blur display username field if length 1")
	    	} else {	    		
    			$("#password").siblings(".errormess").css("display", "block");
    			$("#password").siblings(".errorbar").css("display", "block");
    			console.log("blur display password field on length 1")	    		
	    	}
	    } else if(l < 6 && a == "password") {
	    	$("#password").siblings(".errormess").css("display", "block");
    		$("#password").siblings(".errorbar").css("display", "block");
    		console.log("blur display password error if length less than 6");
	    }  	
    });    	
});


</script>

</body>
</html>